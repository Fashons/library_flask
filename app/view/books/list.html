<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–æ–∏ –∫–Ω–∏–≥–∏ ‚Ä¢ Flask Library</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <div class="page-header">
            <h1 class="page-title">üìö –ú–æ–∏ –∫–Ω–∏–≥–∏</h1>
            <div class="books-actions">
                <a href="{{ url_for('index') }}" class="btn btn-outline">
                    <i class="fas fa-home"></i> –ù–∞ –≥–ª–∞–≤–Ω—É—é
                </a>
                <a href="{{ url_for('auth.logout') }}" class="btn btn-danger">
                    <i class="fas fa-sign-out-alt"></i> –í—ã–π—Ç–∏
                </a>
            </div>
        </div>

        <div class="messages">
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% for category, message in messages %}
                        <div class="alert alert-{{ category == 'error' and 'danger' or category }}">
                            <i class="fas fa-{{ category == 'success' and 'check-circle' or category == 'error' and 'exclamation-circle' or 'info-circle' }}"></i>
                            {{ message }}
                        </div>
                    {% endfor %}
                {% endif %}
            {% endwith %}
        </div>

        <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–Ω–∏–≥–∏ -->
        <div class="book-form card">
            <h2 class="book-form-title"><i class="fas fa-plus-circle"></i> –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –∫–Ω–∏–≥—É</h2>
            <form method="post" action="{{ url_for('books.create_book') }}" class="form-row">
                <div class="form-group">
                    <label for="title" class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–Ω–∏–≥–∏</label>
                    <input type="text" id="title" name="title" class="form-input" required placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–Ω–∏–≥–∏">
                </div>
                <div class="form-group">
                    <label for="author" class="form-label">–ê–≤—Ç–æ—Ä</label>
                    <input type="text" id="author" name="author" class="form-input" required placeholder="–í–≤–µ–¥–∏—Ç–µ –∞–≤—Ç–æ—Ä–∞">
                </div>
                <div class="form-group" style="display: flex; align-items: end;">
                    <button type="submit" class="btn btn-primary" style="width: 100%;">
                        <i class="fas fa-book"></i> –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–∏–≥—É
                    </button>
                </div>
            </form>
        </div>

        <!-- –§–æ—Ä–º–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–Ω–∏–≥–∏ -->
        <div class="book-form card" style="background: linear-gradient(135deg, #f0fdf4 0%, #ecfdf5 100%); border-color: #10b981;">
            <h2 class="book-form-title" style="color: #065f46;"><i class="fas fa-sync-alt"></i> –û–±–Ω–æ–≤–∏—Ç—å –∫–Ω–∏–≥—É</h2>
            <form method="post" action="{{ url_for('books.update_book') }}" class="form-row">
                <div class="form-group">
                    <label for="book-id" class="form-label">ID –∫–Ω–∏–≥–∏</label>
                    <input type="number" id="book-id" name="id" class="form-input" required placeholder="–í–≤–µ–¥–∏—Ç–µ ID –∫–Ω–∏–≥–∏">
                </div>
                <div class="form-group">
                    <label for="new-title" class="form-label">–ù–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ</label>
                    <input type="text" id="new-title" name="new_title" class="form-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ">
                </div>
                <div class="form-group">
                    <label for="new-author" class="form-label">–ù–æ–≤—ã–π –∞–≤—Ç–æ—Ä</label>
                    <input type="text" id="new-author" name="new_author" class="form-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤–æ–≥–æ –∞–≤—Ç–æ—Ä–∞">
                </div>
                <div class="form-group" style="display: flex; align-items: end;">
                    <button type="submit" class="btn btn-secondary" style="width: 100%;">
                        <i class="fas fa-sync-alt"></i> –û–±–Ω–æ–≤–∏—Ç—å –∫–Ω–∏–≥—É
                    </button>
                </div>
            </form>
        </div>

        <!-- –°–ø–∏—Å–æ–∫ –∫–Ω–∏–≥ -->
        <h2 style="font-size: 1.5rem; margin: 2rem 0 1rem; color: var(--text-color);">üìñ –í–∞—à–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞</h2>

        {% if books %}
            <div class="books-list">
                {% for book in books %}
                    <div class="book-card">
                        <div class="book-card-header">
                            <h3 class="book-card-title">{{ book.title }}</h3>
                            <div class="book-card-author">{{ book.author }}</div>
                        </div>
                        <div class="book-card-body">
                            <div class="book-id">ID: <strong>{{ book.id }}</strong></div>
                        </div>
                        <div class="book-card-actions">
                            <form method="post" action="{{ url_for('books.delete_book', book_id=book.id) }}" style="width: 100%;">
                                <button type="submit" class="btn btn-danger btn-sm" style="width: 100%;" onclick="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É –∫–Ω–∏–≥—É?')">
                                    <i class="fas fa-trash-alt"></i> –£–¥–∞–ª–∏—Ç—å
                                </button>
                            </form>
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <div class="empty-state">
                <div class="empty-state-icon">
                    <i class="fas fa-book-open"></i>
                </div>
                <h3>–í–∞—à–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –ø—É—Å—Ç–∞</h3>
                <p>–î–æ–±–∞–≤—å—Ç–µ —Å–≤–æ—é –ø–µ—Ä–≤—É—é –∫–Ω–∏–≥—É, –∏—Å–ø–æ–ª—å–∑—É—è —Ñ–æ—Ä–º—É –≤—ã—à–µ</p>
                <a href="#" class="btn btn-primary" onclick="document.querySelector('#title').focus(); return false;">
                    <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–∏–≥—É
                </a>
            </div>
        {% endif %}
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // –ê–≤—Ç–æ—Ñ–æ–∫—É—Å –Ω–∞ –ø–æ–ª–µ –Ω–∞–∑–≤–∞–Ω–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            document.getElementById('title').focus();

            // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ —Ñ–æ—Ä–º—ã –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏
            const bookCards = document.querySelectorAll('.book-card');
            bookCards.forEach(card => {
                card.addEventListener('mouseenter', function() {
                    this.style.borderColor = '#6366f1';
                });

                card.addEventListener('mouseleave', function() {
                    this.style.borderColor = '#e2e8f0';
                });
            });
        });
    </script>
</body>
</html>